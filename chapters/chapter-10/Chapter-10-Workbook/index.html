
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive guide to the foundations of quantum computing">
      
      
        <meta name="author" content="Big Book of Computing">
      
      
        <link rel="canonical" href="https://bigbookofcomputing.github.io/chapters/chapter-10/Chapter-10-Workbook/">
      
      
        <link rel="prev" href="../../chapter-9/Chapter-9-Workbook/">
      
      
        <link rel="next" href="../../chapter-11/Chapter-11-Workbook/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Chapter-10 Variational Quantum Classifiers - Big Book of Computing | Quantum Computing</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
      <link rel="stylesheet" href="../../../static/styles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ECS7B3X8JM"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ECS7B3X8JM",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ECS7B3X8JM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-10-variational-quantum-circuits" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Big Book of Computing | Quantum Computing" class="md-header__button md-logo" aria-label="Big Book of Computing | Quantum Computing" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Book of Computing | Quantum Computing
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter-10 Variational Quantum Classifiers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bigbookofcomputing/quantum" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contents/" class="md-tabs__link">
        
  
  
    
  
  Contents

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../introduction/" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-Essay/" class="md-tabs__link">
          
  
  
    
  
  Chapters

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../chapter-1/Chapter-1-Workbook/" class="md-tabs__link">
          
  
  
    
  
  WorkBooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-Codebook/" class="md-tabs__link">
          
  
  
    
  
  CodeBooks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Big Book of Computing | Quantum Computing" class="md-nav__button md-logo" aria-label="Big Book of Computing | Quantum Computing" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    Big Book of Computing | Quantum Computing
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bigbookofcomputing/quantum" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contents
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chapters
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chapters
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 State and Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Gate and Circuits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Quantum Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Quantum Fourier Transform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Variational Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Quantum Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 Quantum Machine Learning and Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Encoding Classical Data into Quantum States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-10-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Variational Quantum Classifiers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Supervised Quantum Machine Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Unsupervised Quantum Machine Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Quantum Reinforcement Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 QUBO Family of Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Quantum Data Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-16 Quantum Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-17 Quantum Chemistry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-18/Chapter-18-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-18 Quantum Finance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-19/Chapter-19-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-19 Quantum Hardware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-20/Chapter-20-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-20 Quantum Error Correction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    WorkBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    WorkBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 State and Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Gate and Circuits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Quantum Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Quantum Fourier Transform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Variational Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Quantum Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 Quantum Machine Learning and Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Encoding Classical Data into Quantum States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Variational Quantum Classifiers
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Variational Quantum Classifiers
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#101-parameterized-quantum-circuits-vqc" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.1 Parameterized Quantum Circuits (VQC)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.1 Parameterized Quantum Circuits (VQC)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#102-circuit-ansatze-for-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.2 Circuit Ansätze for Learning
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.2 Circuit Ansätze for Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#103-gradient-estimation-parameter-shift" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.3 Gradient Estimation: Parameter-Shift
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.3 Gradient Estimation: Parameter-Shift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#104-noise-and-shot-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.4 Noise and Shot Complexity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.4 Noise and Shot Complexity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#105-barren-plateaus-and-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.5 Barren Plateaus and Mitigation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.5 Barren Plateaus and Mitigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Supervised Quantum Machine Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Unsupervised Quantum Machine Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Quantum Reinforcement Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 QUBO Family of Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Quantum Data Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-16 Quantum Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-17 Quantum Chemistry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-18/Chapter-18-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-18 Quantum Finance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-19/Chapter-19-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-19 Quantum Hardware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-20/Chapter-20-Workbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-20 Quantum Error Correction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CodeBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    CodeBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 State and Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Gate and Circuits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Quantum Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Quantum Fourier Transform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Variational Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Quantum Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 Quantum Machine Learning and Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Encoding Classical Data into Quantum States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-10-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Variational Quantum Classifiers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Supervised Quantum Machine Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Unsupervised Quantum Machine Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Quantum Reinforcement Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 QUBO Family of Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Quantum Data Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-16 Quantum Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-17 Quantum Chemistry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-18/Chapter-18-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-18 Quantum Finance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-19/Chapter-19-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-19 Quantum Hardware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-20/Chapter-20-Codebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-20 Quantum Error Correction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#101-parameterized-quantum-circuits-vqc" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.1 Parameterized Quantum Circuits (VQC)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.1 Parameterized Quantum Circuits (VQC)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#102-circuit-ansatze-for-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.2 Circuit Ansätze for Learning
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.2 Circuit Ansätze for Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#103-gradient-estimation-parameter-shift" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.3 Gradient Estimation: Parameter-Shift
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.3 Gradient Estimation: Parameter-Shift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#104-noise-and-shot-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.4 Noise and Shot Complexity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.4 Noise and Shot Complexity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#105-barren-plateaus-and-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.5 Barren Plateaus and Mitigation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.5 Barren Plateaus and Mitigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-projects_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Projects
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Projects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-blueprint_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/bigbookofcomputing/quantum/edit/master/docs/chapters/chapter-10/Chapter-10-Workbook.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/bigbookofcomputing/quantum/raw/master/docs/chapters/chapter-10/Chapter-10-Workbook.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="chapter-10-variational-quantum-circuits"><strong>Chapter 10: Variational Quantum Circuits</strong></h1>
<hr />
<blockquote>
<p><strong>Summary:</strong> This chapter deconstructs Variational Quantum Circuits (VQCs), the cornerstone of near-term quantum machine learning. We explore the hybrid quantum-classical paradigm where parameterized quantum circuits are iteratively trained via classical optimizers to solve complex problems. The chapter details the three-stage VQC architecture—encoding, parameterization, and measurement—and examines the critical design principles of circuit ansätze that balance expressibility with trainability. Finally, we confront the notorious barren plateau problem, a key obstacle in the practical deployment of VQCs on NISQ-era hardware.</p>
</blockquote>
<hr />
<p>The goal of this chapter is to establish the foundational concepts and techniques of Variational Quantum Classifiers (VQC), exploring how quantum computing can enhance traditional classification frameworks.</p>
<hr />
<h2 class="heading-with-pill" id="101-parameterized-quantum-circuits-vqc"><strong>10.1 Parameterized Quantum Circuits (VQC)</strong></h2>
<blockquote>
<p><strong>Difficulty:</strong> ★★★☆☆</p>
<p><strong>Concept:</strong> Trainable quantum models with data encoders and parameterized unitaries</p>
<p><strong>Summary:</strong> A VQC prepares <span class="arithmatex">\(\lvert\psi(x,\mathbf{\theta})\rangle = \mathbf{U}(\mathbf{\theta})\,\mathbf{U}_\phi(x)\,\lvert 0\rangle^{\otimes n}\)</span> and predicts from expectation values of observables; training updates <span class="arithmatex">\(\mathbf{\theta}\)</span> to minimize a loss.</p>
</blockquote>
<h3 id="theoretical-background"><strong>Theoretical Background</strong></h3>
<p>Variational Quantum Circuits (VQCs) are hybrid quantum-classical models that parameterize quantum states and use classical optimization to minimize task-specific loss functions, enabling quantum machine learning on NISQ devices.</p>
<p><strong>Three-Stage VQC Architecture:</strong></p>
<p>A VQC consists of three sequential operations:</p>
<p><strong>1. Data Encoding (<span class="arithmatex">\(\mathbf{U}_{\Phi}(x)\)</span>):</strong><br />
Map classical input <span class="arithmatex">\(x \in \mathbb{R}^d\)</span> to quantum state via feature map:</p>
<div class="arithmatex">\[
\mathbf{U}_{\Phi}(x)|0\rangle^{\otimes n} = |\phi(x)\rangle
\]</div>
<p>Common encoding schemes:</p>
<p><strong>Angle Encoding:</strong>
$$
\mathbf{U}<em i="1">{\Phi}(x) = \bigotimes</em>_i
$$}^{\min(d,n)} R_y(x_i) = \prod_{i=1}^{\min(d,n)} \begin{pmatrix} \cos(x_i/2) &amp; -\sin(x_i/2) \ \sin(x_i/2) &amp; \cos(x_i/2) \end{pmatrix</p>
<p><strong>Amplitude Encoding:</strong><br />
For <span class="arithmatex">\(d = 2^n\)</span>, encode normalized vector <span class="arithmatex">\(\mathbf{x}/\|\mathbf{x}\|\)</span> as amplitudes:</p>
<div class="arithmatex">\[
|\phi(x)\rangle = \frac{1}{\|\mathbf{x}\|}\sum_{i=0}^{2^n-1} x_i |i\rangle
\]</div>
<p>Requires <span class="arithmatex">\(\Theta(2^n)\)</span> gates for arbitrary data.</p>
<p><strong>IQP-Inspired Encoding:</strong><br />
Apply Hadamards, then diagonal unitaries encoding feature products:</p>
<div class="arithmatex">\[
\mathbf{U}_{\Phi}(x) = U_Z(x) \mathbf{H}^{\otimes n}, \quad U_Z(x) = \exp\left(-i\sum_{S \subseteq [n]} \phi_S(x) \prod_{j \in S} Z_j\right)
\]</div>
<p>where <span class="arithmatex">\(\phi_S(x) = \sum_{k \in S} x_k\)</span> or polynomial features.</p>
<p><strong>2. Variational Ansatz (<span class="arithmatex">\(\mathbf{U}(\vec{\theta})\)</span>):</strong><br />
Parameterized unitary with trainable parameters <span class="arithmatex">\(\vec{\theta} = (\theta_1, \ldots, \theta_m)\)</span>:</p>
<div class="arithmatex">\[
\mathbf{U}(\vec{\theta}) = \prod_{\ell=1}^L \mathbf{W}_{\text{ent}}^{(\ell)} \cdot \mathbf{R}(\vec{\theta}_{\ell})
\]</div>
<p>where:
- <span class="arithmatex">\(\mathbf{R}(\vec{\theta}_{\ell}) = \bigotimes_{i=1}^n R_y(\theta_{\ell,i})\)</span> are single-qubit rotations<br />
- <span class="arithmatex">\(\mathbf{W}_{\text{ent}}^{(\ell)}\)</span> is entangling layer (e.g., CNOT ladder)</p>
<p><strong>Combined State:</strong>
$$
|\psi(x;\vec{\theta})\rangle = \mathbf{U}(\vec{\theta}) \cdot \mathbf{U}_{\Phi}(x) \cdot |0\rangle^{\otimes n}
$$</p>
<p><strong>3. Measurement and Prediction:</strong><br />
Measure observable <span class="arithmatex">\(\mathbf{M}\)</span> (Hermitian operator) to extract prediction:</p>
<div class="arithmatex">\[
\langle \mathbf{M} \rangle_{x,\vec{\theta}} = \langle\psi(x;\vec{\theta})|\mathbf{M}|\psi(x;\vec{\theta})\rangle
\]</div>
<p><strong>Binary Classification:</strong><br />
For labels <span class="arithmatex">\(y \in \{-1, +1\}\)</span>, predict:</p>
<div class="arithmatex">\[
\hat{y}(x;\vec{\theta}) = \text{sign}\left(\langle \mathbf{M} \rangle_{x,\vec{\theta}} - b\right)
\]</div>
<p>where <span class="arithmatex">\(b \in \mathbb{R}\)</span> is bias threshold (often <span class="arithmatex">\(b=0\)</span>).</p>
<p>Typical observables:
- Single-qubit: <span class="arithmatex">\(\mathbf{M} = \mathbf{Z}_0\)</span> (measure first qubit)<br />
- Global: <span class="arithmatex">\(\mathbf{M} = \sum_{i=0}^{n-1} \mathbf{Z}_i\)</span> (parity)<br />
- Custom: <span class="arithmatex">\(\mathbf{M} = \sum_j c_j \mathbf{P}_j\)</span> where <span class="arithmatex">\(\mathbf{P}_j\)</span> are Pauli strings</p>
<p><strong>Loss Functions:</strong></p>
<p><strong>Mean Squared Error (Regression/Classification):</strong>
$$
\mathcal{L}<em i="1">{\text{MSE}}(\vec{\theta}) = \frac{1}{N}\sum</em>\right)^2
$$}^N \left(y_i - \langle\mathbf{M}\rangle_{x_i,\vec{\theta}</p>
<p><strong>Hinge Loss (SVM-style):</strong>
$$
\mathcal{L}<em i="1">{\text{hinge}}(\vec{\theta}) = \frac{1}{N}\sum</em>\right)
$$}^N \max\left(0, 1 - y_i \langle\mathbf{M}\rangle_{x_i,\vec{\theta}</p>
<p><strong>Cross-Entropy (Multi-class with softmax):</strong><br />
For <span class="arithmatex">\(C\)</span> classes, measure <span class="arithmatex">\(C\)</span> observables <span class="arithmatex">\(\{\mathbf{M}_c\}\)</span>:</p>
<div class="arithmatex">\[
p_c(x;\vec{\theta}) = \frac{e^{\langle\mathbf{M}_c\rangle_{x,\vec{\theta}}}}{\sum_{c'=1}^C e^{\langle\mathbf{M}_{c'}\rangle_{x,\vec{\theta}}}}
\]</div>
<div class="arithmatex">\[
\mathcal{L}_{\text{CE}}(\vec{\theta}) = -\frac{1}{N}\sum_{i=1}^N \sum_{c=1}^C \mathbb{1}[y_i = c] \log p_c(x_i;\vec{\theta})
\]</div>
<p><strong>Training via Gradient Descent:</strong></p>
<p>Update rule:
$$
\vec{\theta}<em _vec_theta="\vec{\theta">{k+1} = \vec{\theta}_k - \eta \nabla</em>_k)
$$}} \mathcal{L}(\vec{\theta</p>
<p>where <span class="arithmatex">\(\eta &gt; 0\)</span> is learning rate.</p>
<p><strong>Parameter-Shift Rule for Gradients:</strong><br />
For gates <span class="arithmatex">\(U(\theta_j) = e^{-i\theta_j G_j}\)</span> with generator <span class="arithmatex">\(G_j\)</span> satisfying <span class="arithmatex">\(G_j^2 = \mathbf{I}\)</span> (eigenvalues <span class="arithmatex">\(\pm 1\)</span>):</p>
<div class="arithmatex">\[
\frac{\partial \langle\mathbf{M}\rangle}{\partial \theta_j} = \frac{1}{2}\left[\langle\mathbf{M}\rangle_{\vec{\theta}^+} - \langle\mathbf{M}\rangle_{\vec{\theta}^-}\right]
\]</div>
<p>where <span class="arithmatex">\(\vec{\theta}^\pm = \vec{\theta} \pm \frac{\pi}{2}\hat{e}_j\)</span>.</p>
<p><strong>Proof Sketch:</strong><br />
Expand state in eigenbasis of <span class="arithmatex">\(G_j\)</span>:</p>
<div class="arithmatex">\[
U(\theta_j) = \cos(\theta_j/2)\mathbf{I} - i\sin(\theta_j/2)G_j
\]</div>
<p>Differentiating:</p>
<div class="arithmatex">\[
\frac{\partial U}{\partial \theta_j} = -\frac{1}{2}\sin(\theta_j/2)\mathbf{I} - \frac{i}{2}\cos(\theta_j/2)G_j
\]</div>
<p>Applying product rule and using <span class="arithmatex">\(U(\theta \pm \pi/2)\)</span> evaluations yields the shift formula.</p>
<p><strong>Hybrid Training Loop:</strong></p>
<ol>
<li><strong>Initialize:</strong> Random <span class="arithmatex">\(\vec{\theta}_0 \sim \mathcal{N}(0, \sigma^2)\)</span> or small values  </li>
<li><strong>Forward Pass:</strong> Prepare <span class="arithmatex">\(|\psi(x_i;\vec{\theta}_k)\rangle\)</span>, measure <span class="arithmatex">\(\langle\mathbf{M}\rangle\)</span> for all training samples  </li>
<li><strong>Compute Loss:</strong> Evaluate <span class="arithmatex">\(\mathcal{L}(\vec{\theta}_k)\)</span> from measurements  </li>
<li><strong>Gradient Estimation:</strong> Use parameter-shift or SPSA to estimate <span class="arithmatex">\(\nabla_{\vec{\theta}} \mathcal{L}\)</span>  </li>
<li><strong>Classical Update:</strong> Apply optimizer (SGD, Adam, BFGS) to update <span class="arithmatex">\(\vec{\theta}\)</span>  </li>
<li><strong>Iterate:</strong> Repeat until convergence or budget exhaustion</li>
</ol>
<pre class="mermaid"><code>flowchart LR
    A[Classical x] --&gt; B["Encode U_Φ(x)"]
    B --&gt; C["Parametric U(θ)"]
    C --&gt; D["Measure ⟨M⟩"]
    D --&gt; E[Classical loss]
    E --&gt; F[Optimizer update θ]
    F --&gt; C</code></pre>
<h3 id="comprehension-check"><strong>Comprehension Check</strong></h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. Which layer embeds classical data into the quantum state?</strong></p>
<ul>
<li>A. Measurement  </li>
<li>B. <span class="arithmatex">\(\mathbf{U}_\phi(x)\)</span>  </li>
<li>C. <span class="arithmatex">\(\mathbf{U}(\mathbf{\theta})\)</span>  </li>
<li>D. Identity  </li>
</ul>
<p><strong>2. A simple VQC prediction can be formed from which quantity?</strong></p>
<ul>
<li>A. Circuit depth  </li>
<li>B. <span class="arithmatex">\(\langle \mathbf{M} \rangle\)</span> for some observable <span class="arithmatex">\(\mathbf{M}\)</span>  </li>
<li>C. Number of qubits  </li>
<li>D. Number of CNOTs  </li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>1: B</strong> — The encoder <span class="arithmatex">\(\mathbf{U}_\phi(x)\)</span> maps <span class="arithmatex">\(x\)</span> into Hilbert space.<br />
<strong>2: B</strong> — Expectation values provide scalar predictions.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Distinguish the roles of <span class="arithmatex">\(\mathbf{U}_\phi(x)\)</span> and <span class="arithmatex">\(\mathbf{U}(\mathbf{\theta})\)</span> in terms of feature mapping vs. learning capacity.</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>In a Variational Quantum Classifier (VQC), the circuit is typically split into two distinct unitaries: the data encoder <span class="arithmatex">\(U_\phi(x)\)</span> and the variational ansatz <span class="arithmatex">\(U(\theta)\)</span>.</p>
<ol>
<li>
<p><strong><span class="arithmatex">\(U_\phi(x)\)</span> (The Feature Map):</strong></p>
<ul>
<li><strong>Role:</strong> To encode classical data <span class="arithmatex">\(x\)</span> into a quantum state. It acts as a <strong>fixed, non-trainable feature map</strong>.</li>
<li><strong>Purpose:</strong> To project the classical data into a high-dimensional Hilbert space where patterns may be more easily discernible. The structure of this encoder is chosen based on the problem domain (e.g., angle encoding for tabular data, ZZ feature maps for capturing correlations).</li>
<li><strong>Analogy:</strong> Similar to feature engineering or applying a kernel in classical machine learning.</li>
</ul>
</li>
<li>
<p><strong><span class="arithmatex">\(U(\theta)\)</span> (The Learning Circuit):</strong></p>
<ul>
<li><strong>Role:</strong> A <strong>trainable, parameterized quantum circuit</strong> that processes the state prepared by the encoder.</li>
<li><strong>Purpose:</strong> To learn the classification task by finding the optimal parameters <span class="arithmatex">\(\theta\)</span> that map the encoded data to the correct labels. It adjusts the quantum state to align it with a measurement observable that separates the classes.</li>
<li><strong>Analogy:</strong> The hidden layers of a classical neural network, where the weights and biases are learned during training.</li>
</ul>
</li>
</ol>
<p><strong>In short:</strong> <span class="arithmatex">\(U_\phi(x)\)</span> is responsible for <strong>data representation</strong>, while <span class="arithmatex">\(U(\theta)\)</span> is responsible for <strong>learning the model</strong>. This separation allows for modular design and helps manage the complexity of the training process.</p>
</details>
</div>
<h3 id="hands-on-projects"><strong><i class="fa-solid fa-flask"></i> Hands-On Projects</strong></h3>
<h4 id="project-blueprint"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Compute <span class="arithmatex">\(C(\theta)=\langle \psi(\theta)\rvert\mathbf{Z}\lvert\psi(\theta)\rangle\)</span> for <span class="arithmatex">\(\lvert\psi(\theta)\rangle = \mathbf{R}_y(\theta)\,\mathbf{R}_x(\tfrac{\pi}{2})\lvert 0\rangle\)</span>.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>Expectation of Pauli <span class="arithmatex">\(\mathbf{Z}\)</span> after rotations; Bloch-sphere geometry.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>One qubit; apply <span class="arithmatex">\(\mathbf{R}_x(\pi/2)\)</span> then <span class="arithmatex">\(\mathbf{R}_y(\theta)\)</span>; measure <span class="arithmatex">\(\mathbf{Z}\)</span>.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>Derive <span class="arithmatex">\(\lvert\psi(\theta)\rangle\)</span>; compute <span class="arithmatex">\(\langle \mathbf{Z} \rangle\)</span> analytically.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td><span class="arithmatex">\(C(\theta)\)</span> follows a cosine or sine law depending on ordering.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>Angle <span class="arithmatex">\(\theta\)</span>, expectation <span class="arithmatex">\(C(\theta)\)</span>.</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Closed-form matches numeric evaluation.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Formula for <span class="arithmatex">\(C(\theta)\)</span> and brief interpretation.</td>
</tr>
</tbody>
</table>
<h4 id="pseudocode-implementation"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>FUNCTION Calculate_VQC_Expectation(theta):
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    # theta: The angle for the Ry rotation gate.
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    # Step 1: Prepare the initial state |0&gt;.
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    # State vector is [1, 0].
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    initial_state = State_Vector([1, 0])
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    LOG &quot;Initial state: |0&gt;&quot;
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    # Step 2: Apply the Rx(π/2) gate.
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    # This creates a state on the equator of the Bloch sphere.
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    # Rx(π/2)|0&gt; = 1/sqrt(2) * (|0&gt; - i|1&gt;)
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    Rx_gate = Rx_Matrix(PI / 2)
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    state_after_Rx = Matrix_Vector_Multiply(Rx_gate, initial_state)
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    LOG &quot;State after Rx(π/2): &quot;, state_after_Rx
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    # Step 3: Apply the Ry(θ) gate.
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    # This rotates the state around the Y-axis.
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    Ry_gate = Ry_Matrix(theta)
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    final_state = Matrix_Vector_Multiply(Ry_gate, state_after_Rx)
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    LOG &quot;Final state after Ry(θ): &quot;, final_state
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    # Step 4: Compute the expectation value of the Pauli Z observable.
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    # &lt;Z&gt; = &lt;ψ_final| Z |ψ_final&gt;
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    # The analytical result for this sequence is sin(theta).
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    pauli_Z = Pauli_Z_Matrix()
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    expectation_Z = Expectation_Value(final_state, pauli_Z)
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    LOG &quot;Expectation value &lt;Z&gt;: &quot;, expectation_Z
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    # Step 5: Verify against the known analytical result.
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    analytical_result = sin(theta)
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    ASSERT abs(expectation_Z - analytical_result) &lt; 1e-9
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    LOG &quot;Result matches analytical formula sin(θ).&quot;
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    RETURN expectation_Z
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>END FUNCTION
</span></code></pre></div>
<h4 id="outcome-and-interpretation"><strong>Outcome and Interpretation</strong></h4>
<p>You relate rotation angles to measured expectations, grounding how VQCs generate outputs.</p>
<hr />
<h2 class="heading-with-pill" id="102-circuit-ansatze-for-learning"><strong>10.2 Circuit Ansätze for Learning</strong></h2>
<blockquote>
<p><strong>Difficulty:</strong> ★★★☆☆</p>
<p><strong>Concept:</strong> Expressibility vs. trainability trade-offs in template design</p>
<p><strong>Summary:</strong> Hardware-efficient ansätze align with device topology and are shallow; problem-inspired ansätze encode symmetries to focus search and mitigate barren plateaus.</p>
</blockquote>
<h3 id="theoretical-background_1"><strong>Theoretical Background</strong></h3>
<p>The choice of ansatz—the parameterized circuit architecture—determines the trade-off between expressibility (ability to represent target states) and trainability (ability to optimize parameters efficiently).</p>
<p><strong>Expressibility Framework:</strong></p>
<p>An ansatz <span class="arithmatex">\(\mathbf{U}(\vec{\theta})\)</span> with parameters <span class="arithmatex">\(\vec{\theta} \in \Theta \subseteq \mathbb{R}^m\)</span> generates a manifold <span class="arithmatex">\(\mathcal{M} = \{|\psi(\vec{\theta})\rangle : \vec{\theta} \in \Theta\}\)</span> within the Hilbert space <span class="arithmatex">\(\mathcal{H} = \mathbb{C}^{2^n}\)</span>.</p>
<p><strong>Expressibility Measure:</strong><br />
Quantify how uniformly <span class="arithmatex">\(\mathcal{M}\)</span> covers <span class="arithmatex">\(\mathcal{H}\)</span> via Kullback-Leibler divergence from Haar measure:</p>
<div class="arithmatex">\[
\text{Expr}(\mathbf{U}) = D_{KL}(P_{\mathcal{M}} \| P_{\text{Haar}})
\]</div>
<p>Lower values indicate higher expressibility. Random deep circuits approach Haar-random distributions (high expressibility) but suffer trainability issues.</p>
<p><strong>Hardware-Efficient Ansätze:</strong></p>
<p>Designed to match native gate sets and qubit connectivity of quantum processors:</p>
<div class="arithmatex">\[
\mathbf{U}_{\text{HE}}(\vec{\theta}) = \prod_{\ell=1}^L \left[\mathbf{E}_{\mathcal{G}} \cdot \prod_{i=1}^n R_y(\theta_{\ell,i})\right]
\]</div>
<p>where:
- <span class="arithmatex">\(\mathbf{E}_{\mathcal{G}} = \prod_{(i,j) \in \mathcal{G}} \text{CNOT}_{i,j}\)</span> entangles along hardware graph <span class="arithmatex">\(\mathcal{G}\)</span><br />
- <span class="arithmatex">\(L\)</span> is circuit depth (number of layers)<br />
- Total parameters: <span class="arithmatex">\(m = nL\)</span></p>
<p><strong>Common Entangling Patterns:</strong></p>
<p><strong>Linear Chain:</strong>
$$
\mathbf{E}<em i="0">{\text{chain}} = \prod</em>
$$
Depth: }^{n-2} \text{CNOT}_{i,i+1<span class="arithmatex">\(\mathcal{O}(n)\)</span> per layer. Nearest-neighbor only.</p>
<p><strong>Circular Ladder:</strong>
$$
\mathbf{E}<em i="0">{\text{circ}} = \prod</em>
$$
Adds periodic boundary.}^{n-1} \text{CNOT}_{i,(i+1)\bmod n</p>
<p><strong>Brick-Layer (Alternating):</strong>
$$
\mathbf{E}<em _text_="\text{" even="even" i="i">{\text{brick}} = \left[\prod</em>}} \text{CNOT<em _text_="\text{" i="i" odd="odd">{i,i+1}\right] \cdot \left[\prod</em>\right]
$$
Depth: }} \text{CNOT}_{i,i+1<span class="arithmatex">\(\mathcal{O}(1)\)</span> with 2D qubit layout.</p>
<p><strong>All-to-All:</strong>
$$
\mathbf{E}<em i_j="i&lt;j">{\text{all}} = \prod</em>
$$
Maximal entanglement, depth } \text{CNOT}_{i,j<span class="arithmatex">\(\mathcal{O}(n^2)\)</span>, prone to barren plateaus.</p>
<p><strong>Problem-Inspired Ansätze:</strong></p>
<p>Encode domain knowledge and symmetries to restrict search space.</p>
<p><strong>Unitary Coupled Cluster (UCC) for Chemistry:</strong>
$$
\mathbf{U}_{\text{UCC}}(\vec{\theta}) = e^{\mathbf{T}(\vec{\theta}) - \mathbf{T}^\dagger(\vec{\theta})}
$$</p>
<p>where cluster operator includes excitations:</p>
<div class="arithmatex">\[
\mathbf{T}(\vec{\theta}) = \sum_{a,i} \theta_a^i (a_a^\dagger a_i - a_i^\dagger a_a) + \sum_{a&gt;b,i&gt;j} \theta_{ab}^{ij} (a_a^\dagger a_b^\dagger a_j a_i - \text{h.c.})
\]</div>
<p>Preserves particle number and spin symmetries. After Jordan-Wigner transformation, each term becomes Pauli string product.</p>
<p><strong>QAOA-Inspired (Alternating Operators):</strong>
$$
\mathbf{U}<em k="1">{\text{QAOA}}(\vec{\gamma}, \vec{\beta}) = \prod</em>
$$}^p e^{-i\beta_k \mathbf{B}} e^{-i\gamma_k \mathbf{C}</p>
<p>where <span class="arithmatex">\(\mathbf{C}\)</span> encodes problem Hamiltonian, <span class="arithmatex">\(\mathbf{B}\)</span> is mixer (typically <span class="arithmatex">\(\sum_i \mathbf{X}_i\)</span>).</p>
<p><strong>Equivariant Ansätze:</strong><br />
Respect group symmetries <span class="arithmatex">\(\mathcal{G}\)</span> of the problem:</p>
<div class="arithmatex">\[
g \cdot \mathbf{U}(\vec{\theta}) \cdot g^{-1} = \mathbf{U}(\vec{\theta}) \quad \forall g \in \mathcal{G}
\]</div>
<p>Reduces parameter space and prevents optimizer from exploring symmetry-equivalent redundant solutions.</p>
<p><strong>Depth-Expressibility Trade-off:</strong></p>
<p>For <span class="arithmatex">\(n\)</span>-qubit system with Hilbert space dimension <span class="arithmatex">\(D = 2^n\)</span>:</p>
<p><strong>Universal Approximation:</strong><br />
Solovay-Kitaev theorem: Any unitary can be approximated to precision <span class="arithmatex">\(\epsilon\)</span> using:</p>
<div class="arithmatex">\[
L \sim \mathcal{O}\left(\log^c(D/\epsilon)\right) = \mathcal{O}\left(n^c \log^c(1/\epsilon)\right)
\]</div>
<p>gates from finite universal set (e.g., <span class="arithmatex">\(\{H, T, \text{CNOT}\}\)</span>), where <span class="arithmatex">\(c \approx 3.97\)</span>.</p>
<p>For hardware-efficient circuits with structure, empirical depth requirements:
- <strong>Shallow regime</strong> (<span class="arithmatex">\(L \sim 1-3\)</span>): Low expressibility, limited to simple functions<br />
- <strong>Moderate regime</strong> (<span class="arithmatex">\(L \sim \mathcal{O}(\log n)\)</span>): Sufficient for many practical tasks<br />
- <strong>Deep regime</strong> (<span class="arithmatex">\(L \gg n\)</span>): Near-universal but trainability collapses</p>
<p><strong>Entanglement Scaling:</strong></p>
<p>Entanglement entropy of bipartition <span class="arithmatex">\(A\)</span> for state <span class="arithmatex">\(|\psi(\vec{\theta})\rangle\)</span>:</p>
<div class="arithmatex">\[
S_A = -\text{Tr}(\rho_A \log \rho_A), \quad \rho_A = \text{Tr}_{\bar{A}}|\psi\rangle\langle\psi|
\]</div>
<p>For random circuits:
- <strong>Shallow:</strong> <span class="arithmatex">\(S_A \sim \mathcal{O}(L)\)</span> (linear growth)<br />
- <strong>Deep:</strong> <span class="arithmatex">\(S_A \to \min(|A|, |\bar{A}|) \log 2\)</span> (volume-law, maximal)</p>
<p>Volume-law entanglement correlates with barren plateaus.</p>
<p><strong>Trainability vs. Expressibility:</strong></p>
<table>
<thead>
<tr>
<th>Ansatz Type</th>
<th>Expressibility</th>
<th>Trainability</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>Shallow HE (<span class="arithmatex">\(L=1-2\)</span>)</td>
<td>Low</td>
<td>High</td>
<td>Simple classification, initialization</td>
</tr>
<tr>
<td>Moderate HE (<span class="arithmatex">\(L=3-5\)</span>)</td>
<td>Medium</td>
<td>Medium</td>
<td>General-purpose NISQ</td>
</tr>
<tr>
<td>Deep HE (<span class="arithmatex">\(L&gt;10\)</span>)</td>
<td>High</td>
<td>Low</td>
<td>Theoretical studies (barren plateaus)</td>
</tr>
<tr>
<td>UCC/QAOA</td>
<td>Problem-specific</td>
<td>High</td>
<td>Chemistry, optimization</td>
</tr>
<tr>
<td>Equivariant</td>
<td>Constrained</td>
<td>High</td>
<td>Symmetric problems</td>
</tr>
</tbody>
</table>
<h3 id="comprehension-check_1"><strong>Comprehension Check</strong></h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. A key benefit of hardware-efficient ansätze is:</strong></p>
<ul>
<li>A. Guaranteed global minima  </li>
<li>B. Shallow depth and native-gate compatibility  </li>
<li>C. Exact simulation of any Hamiltonian  </li>
<li>D. Zero-shot variance  </li>
</ul>
<p><strong>2. Problem-inspired designs often aim to:</strong></p>
<ul>
<li>A. Randomize parameters heavily  </li>
<li>B. Reduce parameter count and preserve symmetries  </li>
<li>C. Maximize depth regardless of noise  </li>
<li>D. Eliminate measurements  </li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>1: B</strong> — They map efficiently to available hardware.<br />
<strong>2: B</strong> — Symmetry and sparsity improve trainability.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Explain how entanglement pattern and depth influence both expressibility and barren plateau risk.</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>The design of a variational circuit's ansatz involves a critical trade-off between its <strong>expressibility</strong> (ability to represent complex functions) and its <strong>trainability</strong> (avoiding issues like barren plateaus).</p>
<ol>
<li>
<p><strong>Expressibility:</strong></p>
<ul>
<li><strong>Influence of Entanglement:</strong> More entanglement (e.g., all-to-all connections) allows the circuit to generate a wider variety of quantum states, increasing its representative power.</li>
<li><strong>Influence of Depth:</strong> Deeper circuits (more layers) can create more complex quantum states and approximate more complicated functions.</li>
</ul>
</li>
<li>
<p><strong>Barren Plateaus (Trainability Issue):</strong></p>
<ul>
<li><strong>Definition:</strong> A phenomenon where the gradients of the cost function vanish exponentially with the number of qubits, making optimization infeasible.</li>
<li><strong>Influence of Entanglement and Depth:</strong> Highly entangled and deep circuits are prone to becoming "too random." They start to approximate a mathematical structure known as a 2-design, which leads to the gradients flattening out across the parameter landscape.</li>
</ul>
</li>
</ol>
<p><strong>The Trade-off:</strong>
*   <strong>High Expressibility (Deep, Global Entanglement):</strong> Leads to a high risk of barren plateaus, making the circuit untrainable.
*   <strong>High Trainability (Shallow, Local Entanglement):</strong> Reduces the risk of barren plateaus but may result in a circuit that is too simple to capture the complexity of the problem (underfitting).</p>
<p>The key to a good ansatz design is to find a "sweet spot" that is expressive enough for the task but structured and shallow enough to ensure that gradients remain trainable. This often involves using problem-specific knowledge or local entanglement patterns.</p>
</details>
</div>
<h3 id="hands-on-projects_1"><strong><i class="fa-solid fa-flask"></i> Hands-On Projects</strong></h3>
<h4 id="project-blueprint_1"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Determine depth scaling for a hardware-efficient layer with parallel <span class="arithmatex">\(\mathbf{R}_y\)</span> and a serial nearest-neighbor CNOT chain.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>Depth per layer: <span class="arithmatex">\(1\)</span> (rotations in parallel) <span class="arithmatex">\(+ (n-1)\)</span> (serial CNOT chain). Total depth <span class="arithmatex">\(\approx L\,(n-1+1)\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td><span class="arithmatex">\(n\)</span> qubits in a line; <span class="arithmatex">\(L\)</span> layers; consider compilation constraints.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>Derive per-layer depth; extend to <span class="arithmatex">\(L\)</span> layers; discuss parallelization limits.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>Depth grows linearly in <span class="arithmatex">\(n\)</span> per layer and in <span class="arithmatex">\(L\)</span> overall.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td><span class="arithmatex">\(n\)</span>, <span class="arithmatex">\(L\)</span>, per-layer depth, total depth.</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Consistency with gate scheduling assumptions.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Closed-form depth expressions and rationale.</td>
</tr>
</tbody>
</table>
<h4 id="pseudocode-implementation_1"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>FUNCTION Calculate_Ansatz_Depth(num_qubits_n, num_layers_L):
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    # num_qubits_n: The number of qubits.
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    # num_layers_L: The number of times the ansatz layer is repeated.
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    ASSERT num_qubits_n &gt; 1 AND num_layers_L &gt; 0
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    # --- Calculate Depth of a Single Layer ---
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    # Step 1: Depth of the single-qubit rotation layer.
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    # All Ry gates can be applied in parallel.
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    depth_rotations = 1
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    LOG &quot;Depth of parallel rotation layer: &quot;, depth_rotations
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    # Step 2: Depth of the entangling layer.
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    # A chain of CNOTs on a linear topology (q0-q1, q1-q2, ...)
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    # must be applied sequentially.
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    IF num_qubits_n &gt; 1:
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>        depth_cnots = num_qubits_n - 1
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    ELSE:
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>        depth_cnots = 0
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    END IF
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    LOG &quot;Depth of serial CNOT chain: &quot;, depth_cnots
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>    # Step 3: Total depth of one full layer.
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>    depth_per_layer = depth_rotations + depth_cnots
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>    LOG &quot;Depth of a single full layer: &quot;, depth_per_layer
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    # --- Calculate Total Circuit Depth ---
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>    # Step 4: Total depth is the depth of one layer multiplied by L.
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>    total_depth = num_layers_L * depth_per_layer
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>    LOG &quot;Total circuit depth for L=&quot;, num_layers_L, &quot; layers: &quot;, total_depth
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>    RETURN total_depth
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>END FUNCTION
</span></code></pre></div>
<h4 id="outcome-and-interpretation_1"><strong>Outcome and Interpretation</strong></h4>
<p>You quantify how template choices affect depth under simple scheduling assumptions, informing resource planning.</p>
<hr />
<h2 class="heading-with-pill" id="103-gradient-estimation-parameter-shift"><strong>10.3 Gradient Estimation: Parameter-Shift</strong></h2>
<blockquote>
<p><strong>Difficulty:</strong> ★★★★☆</p>
<p><strong>Concept:</strong> Exact derivatives from two evaluations for suitable generators</p>
<p><strong>Summary:</strong> For <span class="arithmatex">\(\mathbf{U}(\theta)=e^{-i\theta\mathbf{G}/2}\)</span> with <span class="arithmatex">\(\mathbf{G}^2=\mathbf{I}\)</span>, the parameter-shift rule yields <span class="arithmatex">\(\partial_\theta E\)</span> from two shifted objective values.</p>
</blockquote>
<h3 id="theoretical-background_2"><strong>Theoretical Background</strong></h3>
<p>The parameter-shift rule provides exact gradients of quantum expectation values for parameterized circuits, enabling gradient-based optimization without numerical differentiation.</p>
<p><strong>Problem Setup:</strong></p>
<p>Given expectation value:</p>
<div class="arithmatex">\[
E(\vec{\theta}) = \langle\psi(\vec{\theta})|\mathbf{M}|\psi(\vec{\theta})\rangle
\]</div>
<p>where <span class="arithmatex">\(|\psi(\vec{\theta})\rangle = \mathbf{U}(\vec{\theta})|0\rangle\)</span> and <span class="arithmatex">\(\mathbf{M}\)</span> is observable, compute partial derivative:</p>
<div class="arithmatex">\[
\frac{\partial E}{\partial \theta_j}
\]</div>
<p><strong>Single-Parameter Gate Structure:</strong></p>
<p>Consider gate generated by Hermitian operator <span class="arithmatex">\(G\)</span> with eigenvalues <span class="arithmatex">\(\lambda_\pm\)</span>:</p>
<div class="arithmatex">\[
U(\theta) = e^{-i\theta G}
\]</div>
<p>If <span class="arithmatex">\(G\)</span> has two distinct eigenvalues (two-point spectrum), normalize so <span class="arithmatex">\(G^2 = \mathbf{I}\)</span> with eigenvalues <span class="arithmatex">\(\pm 1\)</span>.</p>
<p><strong>Eigendecomposition:</strong></p>
<p>Write <span class="arithmatex">\(G = \sum_k \lambda_k |g_k\rangle\langle g_k|\)</span> where <span class="arithmatex">\(\lambda_k \in \{-1, +1\}\)</span>. Then:</p>
<div class="arithmatex">\[
U(\theta) = \sum_k e^{-i\theta \lambda_k}|g_k\rangle\langle g_k|
\]</div>
<p>Expanding exponential via Euler formula:</p>
<div class="arithmatex">\[
e^{-i\theta G} = \cos\theta \sum_k |g_k\rangle\langle g_k| - i\sin\theta \sum_k \lambda_k |g_k\rangle\langle g_k| = \cos\theta \cdot \mathbf{I} - i\sin\theta \cdot G
\]</div>
<p><strong>Derivative Calculation:</strong></p>
<p>Differentiate:</p>
<div class="arithmatex">\[
\frac{\partial U(\theta)}{\partial \theta} = -\sin\theta \cdot \mathbf{I} - i\cos\theta \cdot G
\]</div>
<p>For expectation <span class="arithmatex">\(E(\theta) = \langle\psi(\theta)|\mathbf{M}|\psi(\theta)\rangle\)</span> where <span class="arithmatex">\(|\psi(\theta)\rangle = U(\theta)|\psi_0\rangle\)</span>:</p>
<div class="arithmatex">\[
\frac{\partial E}{\partial \theta} = \left\langle\frac{\partial\psi}{\partial\theta}\middle|\mathbf{M}\middle|\psi\right\rangle + \left\langle\psi\middle|\mathbf{M}\middle|\frac{\partial\psi}{\partial\theta}\right\rangle
\]</div>
<p>Since <span class="arithmatex">\(\mathbf{M}\)</span> is Hermitian, these are complex conjugates. Computing:</p>
<div class="arithmatex">\[
\frac{\partial E}{\partial \theta} = 2\text{Re}\left\langle\frac{\partial U}{\partial\theta}\psi_0\middle|\mathbf{M}\middle|U(\theta)\psi_0\right\rangle
\]</div>
<p><strong>Shift Formula Derivation:</strong></p>
<p>Evaluate <span class="arithmatex">\(U(\theta)\)</span> at shifted points <span class="arithmatex">\(\theta \pm s\)</span>:</p>
<div class="arithmatex">\[
U(\theta + s) = \cos(\theta+s)\mathbf{I} - i\sin(\theta+s)G
\]</div>
<div class="arithmatex">\[
U(\theta - s) = \cos(\theta-s)\mathbf{I} - i\sin(\theta-s)G
\]</div>
<p>Taking difference:</p>
<div class="arithmatex">\[
U(\theta+s) - U(\theta-s) = [\cos(\theta+s)-\cos(\theta-s)]\mathbf{I} - i[\sin(\theta+s)-\sin(\theta-s)]G
\]</div>
<p>Using trigonometric identities:</p>
<div class="arithmatex">\[
\cos(\theta+s) - \cos(\theta-s) = -2\sin\theta\sin s
$$
$$
\sin(\theta+s) - \sin(\theta-s) = 2\cos\theta\sin s
\]</div>
<p>Thus:</p>
<div class="arithmatex">\[
U(\theta+s) - U(\theta-s) = -2\sin s(\sin\theta \cdot \mathbf{I} + i\cos\theta \cdot G)
\]</div>
<p>For <span class="arithmatex">\(s = \pi/2\)</span>, <span class="arithmatex">\(\sin s = 1\)</span>:</p>
<div class="arithmatex">\[
U(\theta+\pi/2) - U(\theta-\pi/2) = -2(\sin\theta \cdot \mathbf{I} + i\cos\theta \cdot G) = 2i\frac{\partial U}{\partial\theta}
\]</div>
<p>Applying to expectation:</p>
<div class="arithmatex">\[
E(\theta+\pi/2) - E(\theta-\pi/2) = 2\text{Im}\left\langle\psi_0\middle|U^\dagger(\theta)\frac{\partial U}{\partial\theta}\mathbf{M}\middle|\psi(\theta)\right\rangle
\]</div>
<p>After algebra involving the derivative structure:</p>
<div class="arithmatex">\[
\frac{\partial E}{\partial\theta} = \frac{1}{2}\left[E(\theta+\pi/2) - E(\theta-\pi/2)\right]
\]</div>
<p><strong>Multi-Parameter Extension:</strong></p>
<p>For circuit <span class="arithmatex">\(\mathbf{U}(\vec{\theta}) = \prod_{j=1}^m U_j(\theta_j)\)</span>, the gradient of expectation:</p>
<div class="arithmatex">\[
\frac{\partial E}{\partial \theta_j} = \frac{1}{2}\left[E(\vec{\theta}^+_j) - E(\vec{\theta}^-_j)\right]
\]</div>
<p>where <span class="arithmatex">\(\vec{\theta}^\pm_j = \vec{\theta} \pm \frac{\pi}{2}\hat{e}_j\)</span>.</p>
<p><strong>Computational Cost:</strong>
- Per parameter: 2 circuit evaluations<br />
- For <span class="arithmatex">\(m\)</span> parameters: <span class="arithmatex">\(2m\)</span> total evaluations<br />
- Each evaluation requires <span class="arithmatex">\(N_{\text{shots}}\)</span> measurements</p>
<p>Total shots per gradient: <span class="arithmatex">\(2m \times N_{\text{shots}}\)</span></p>
<p><strong>General Shift Rules:</strong></p>
<p>For generators with eigenvalue spectrum <span class="arithmatex">\(\{\lambda_1, \ldots, \lambda_r\}\)</span>:</p>
<div class="arithmatex">\[
\frac{\partial E}{\partial\theta} = \sum_{k=1}^{r-1} c_k \left[E(\theta + s_k) - E(\theta - s_k)\right]
\]</div>
<p>where shifts <span class="arithmatex">\(s_k\)</span> and coefficients <span class="arithmatex">\(c_k\)</span> depend on eigenvalue gaps. For Pauli generators (<span class="arithmatex">\(r=2\)</span>), recovers <span class="arithmatex">\(\pi/2\)</span> shift.</p>
<p><strong>Advantages:</strong>
1. <strong>Exactness:</strong> No finite-difference approximation error<br />
2. <strong>Hardware compatibility:</strong> Uses actual circuit evaluations<br />
3. <strong>Noise resilience:</strong> Averages over shot noise with proper statistics<br />
4. <strong>Barren plateau awareness:</strong> Gradient magnitude directly measured</p>
<p><strong>Limitations:</strong>
1. <strong>Scalability:</strong> <span class="arithmatex">\(\mathcal{O}(m)\)</span> cost prohibitive for <span class="arithmatex">\(m &gt; 100\)</span><br />
2. <strong>Noise accumulation:</strong> Each evaluation subject to device errors<br />
3. <strong>Barren plateaus:</strong> Cannot overcome exponentially small gradients<br />
4. <strong>Non-Pauli gates:</strong> Require generalized shifts (e.g., controlled rotations need 4+ evaluations)</p>
<p><strong>Comparison with Finite Differences:</strong></p>
<p>Central difference approximation:</p>
<div class="arithmatex">\[
\frac{\partial E}{\partial\theta} \approx \frac{E(\theta+h) - E(\theta-h)}{2h}
\]</div>
<p>Error: <span class="arithmatex">\(\mathcal{O}(h^2)\)</span> plus shot noise amplification <span class="arithmatex">\(\mathcal{O}(1/h)\)</span> for small <span class="arithmatex">\(h\)</span>. Parameter-shift avoids this trade-off with exact formula.</p>
<h3 id="comprehension-check_2"><strong>Comprehension Check</strong></h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. Parameter-shift requires what property of the generator?</strong></p>
<ul>
<li>A. Non-Hermitian  </li>
<li>B. Two-point spectrum (involutory up to scale)  </li>
<li>C. Nilpotent  </li>
<li>D. Non-unitary  </li>
</ul>
<p><strong>2. How many evaluations per parameter are needed?</strong></p>
<ul>
<li>A. One  </li>
<li>B. Two  </li>
<li>C. <span class="arithmatex">\(d\)</span>  </li>
<li>D. <span class="arithmatex">\(2d\)</span>  </li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>1: B</strong> — Eigenvalues <span class="arithmatex">\(\pm 1\)</span> admit shifts by <span class="arithmatex">\(\pm\pi/2\)</span>.<br />
<strong>2: B</strong> — Two evaluations suffice per parameter.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Compare parameter-shift with SPSA in terms of query cost and noise tolerance.</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>When training VQCs, the choice of gradient estimator involves a trade-off between cost and precision. The two most common methods are the Parameter-Shift Rule and Simultaneous Perturbation Stochastic Approximation (SPSA).</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Parameter-Shift Rule</th>
<th>SPSA (Simultaneous Perturbation Stochastic Approx.)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Query Cost</strong></td>
<td><strong>High (<span class="arithmatex">\(2m\)</span> circuits per gradient)</strong>, where <span class="arithmatex">\(m\)</span> is the number of parameters.</td>
<td><strong>Low (2 circuits per gradient)</strong>, regardless of <span class="arithmatex">\(m\)</span>.</td>
</tr>
<tr>
<td><strong>Gradient Quality</strong></td>
<td><strong>Exact</strong>. It provides the analytical gradient, limited only by shot noise.</td>
<td><strong>Stochastic</strong>. It's an approximation, introducing its own noise.</td>
</tr>
<tr>
<td><strong>Noise Tolerance</strong></td>
<td><strong>Moderate</strong>. It's robust to shot noise but can be sensitive to device control errors.</td>
<td><strong>High</strong>. Its stochastic nature makes it inherently resilient to device noise.</td>
</tr>
<tr>
<td><strong>Scalability</strong></td>
<td><strong>Poor</strong>. The cost becomes prohibitive for models with many parameters (<span class="arithmatex">\(m &gt; 100\)</span>).</td>
<td><strong>Excellent</strong>. It is the preferred method for large-scale models.</td>
</tr>
<tr>
<td><strong>Best For</strong></td>
<td>Small models, high-precision optimization, or final fine-tuning.</td>
<td>Large models, noisy hardware, and initial, rapid exploration of the parameter space.</td>
</tr>
</tbody>
</table>
<p><strong>Summary:</strong>
- Use <strong>Parameter-Shift</strong> for small, precise models where accuracy is paramount and the cost is manageable.
- Use <strong>SPSA</strong> for large, complex models, especially on noisy hardware, where scalability and cost-efficiency are the primary concerns. A common strategy is to use SPSA for initial training and switch to parameter-shift for final convergence.</p>
</details>
</div>
<h3 id="hands-on-projects_2"><strong><i class="fa-solid fa-flask"></i> Hands-On Projects</strong></h3>
<h4 id="project-blueprint_2"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Apply parameter-shift to <span class="arithmatex">\(C(\theta)=-\cos\theta\)</span> at <span class="arithmatex">\(\theta=\pi/4\)</span> and compare to analytic derivative.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td><span class="arithmatex">\(\partial_\theta C(\theta)=\sin\theta\)</span>; shift estimator with <span class="arithmatex">\(\pm\pi/2\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Use closed-form <span class="arithmatex">\(C\)</span>; compute two shifted values and difference/2.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>Evaluate <span class="arithmatex">\(C(\pi/4\pm\pi/2)\)</span>; form estimate; compare to <span class="arithmatex">\(\sin(\pi/4)\)</span>.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>Exact agreement in noise-free algebra.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td><span class="arithmatex">\(C_+\)</span>, <span class="arithmatex">\(C_-\)</span>, estimate, analytic value.</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Equality within arithmetic precision.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Numeric comparison table (conceptual).</td>
</tr>
</tbody>
</table>
<h4 id="pseudocode-implementation_2"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>FUNCTION Demonstrate_Parameter_Shift_Rule(CostFunction, theta):
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    # CostFunction: A function C(θ) that returns a scalar value, e.g., -cos(θ).
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    # theta: The parameter value at which to compute the gradient.
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    # Step 1: Define the shift amount.
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    # For Pauli-based gates, the shift is π/2.
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    shift = PI / 2
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    LOG &quot;Using parameter shift amount: &quot;, shift
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    # Step 2: Evaluate the cost function at the shifted points.
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    cost_plus = CostFunction(theta + shift)
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    cost_minus = CostFunction(theta - shift)
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    LOG &quot;C(θ + π/2) = &quot;, cost_plus
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    LOG &quot;C(θ - π/2) = &quot;, cost_minus
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    # Step 3: Apply the parameter-shift formula to estimate the gradient.
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    # The formula for a single parameter is (C(θ+s) - C(θ-s)) / (2*sin(s))
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>    # For s=π/2, this simplifies to (C(θ+π/2) - C(θ-π/2)) / 2.
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>    gradient_estimate = (cost_plus - cost_minus) / 2.0
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>    LOG &quot;Parameter-shift gradient estimate: &quot;, gradient_estimate
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>    # Step 4: Compare with the analytical derivative for verification.
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>    # For C(θ) = -cos(θ), the derivative is dC/dθ = sin(θ).
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>    analytical_gradient = sin(theta)
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>    LOG &quot;Analytical gradient: &quot;, analytical_gradient
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>    # Step 5: Check if the estimate matches the true value.
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>    ASSERT abs(gradient_estimate - analytical_gradient) &lt; 1e-9
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>    LOG &quot;Verification successful: The estimate matches the analytical gradient.&quot;
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>    RETURN gradient_estimate
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>END FUNCTION
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>// Example usage:
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>// Demonstrate_Parameter_Shift_Rule(lambda t: -cos(t), PI / 4)
</span></code></pre></div>
<h4 id="outcome-and-interpretation_2"><strong>Outcome and Interpretation</strong></h4>
<p>You verify the parameter-shift estimator and its exactness for simple generators.</p>
<hr />
<h2 class="heading-with-pill" id="104-noise-and-shot-complexity"><strong>10.4 Noise and Shot Complexity</strong></h2>
<blockquote>
<p><strong>Difficulty:</strong> ★★★☆☆</p>
<p><strong>Concept:</strong> Finite-sample variance and measurement budgeting</p>
<p><strong>Summary:</strong> Expectation estimates have variance <span class="arithmatex">\(\mathcal{O}(1/N_{\text{shots}})\)</span>; reducing error bars requires more shots or grouping strategies and dominates runtime in training loops.</p>
</blockquote>
<h3 id="theoretical-background_3"><strong>Theoretical Background</strong></h3>
<p>Finite-sample measurement introduces statistical noise that dominates computational cost in variational quantum algorithms, requiring careful shot budgeting and variance reduction strategies.</p>
<p><strong>Measurement Statistics:</strong></p>
<p>Measuring observable <span class="arithmatex">\(\mathbf{M}\)</span> with eigenvalues <span class="arithmatex">\(\{m_k\}\)</span> on state <span class="arithmatex">\(\rho\)</span> yields outcome <span class="arithmatex">\(m_k\)</span> with probability:</p>
<div class="arithmatex">\[
p_k = \text{Tr}(\mathbf{M}_k \rho), \quad \mathbf{M}_k = |m_k\rangle\langle m_k|
\]</div>
<p>Expectation value:</p>
<div class="arithmatex">\[
\langle\mathbf{M}\rangle = \text{Tr}(\mathbf{M}\rho) = \sum_k m_k p_k
\]</div>
<p><strong>Shot Noise Analysis:</strong></p>
<p>With <span class="arithmatex">\(N\)</span> independent measurements <span class="arithmatex">\(\{m^{(i)}\}_{i=1}^N\)</span>, empirical estimator:</p>
<div class="arithmatex">\[
\widehat{\langle\mathbf{M}\rangle}_N = \frac{1}{N}\sum_{i=1}^N m^{(i)}
\]</div>
<p>This is unbiased: <span class="arithmatex">\(\mathbb{E}[\widehat{\langle\mathbf{M}\rangle}_N] = \langle\mathbf{M}\rangle\)</span></p>
<p><strong>Variance:</strong></p>
<div class="arithmatex">\[
\text{Var}[\widehat{\langle\mathbf{M}\rangle}_N] = \frac{1}{N}\text{Var}[m^{(1)}] = \frac{1}{N}\left(\langle\mathbf{M}^2\rangle - \langle\mathbf{M}\rangle^2\right)
\]</div>
<p>For Pauli operators with eigenvalues <span class="arithmatex">\(\pm 1\)</span>:</p>
<div class="arithmatex">\[
\mathbf{M}^2 = \mathbf{I} \implies \langle\mathbf{M}^2\rangle = 1
\]</div>
<p>Thus:</p>
<div class="arithmatex">\[
\text{Var}[\widehat{\langle\mathbf{M}\rangle}_N] = \frac{1 - \langle\mathbf{M}\rangle^2}{N}
\]</div>
<p>Maximum variance (at <span class="arithmatex">\(\langle\mathbf{M}\rangle = 0\)</span>): <span class="arithmatex">\(\sigma^2 = 1/N\)</span></p>
<p><strong>Standard Error:</strong></p>
<div class="arithmatex">\[
\sigma[\widehat{\langle\mathbf{M}\rangle}_N] = \sqrt{\text{Var}} = \frac{\sqrt{1 - \langle\mathbf{M}\rangle^2}}{\sqrt{N}}
\]</div>
<p>Confidence interval (95%):</p>
<div class="arithmatex">\[
\langle\mathbf{M}\rangle \in \left[\widehat{\langle\mathbf{M}\rangle}_N \pm 1.96\sigma\right]
\]</div>
<p><strong>Shot Requirement for Precision:</strong></p>
<p>To achieve standard error <span class="arithmatex">\(\epsilon\)</span>:</p>
<div class="arithmatex">\[
\frac{1}{\sqrt{N}} \leq \epsilon \implies N \geq \frac{1}{\epsilon^2}
\]</div>
<p><strong>Examples:</strong>
- <span class="arithmatex">\(\epsilon = 0.1\)</span>: <span class="arithmatex">\(N \geq 100\)</span> shots<br />
- <span class="arithmatex">\(\epsilon = 0.01\)</span>: <span class="arithmatex">\(N \geq 10,000\)</span> shots<br />
- <span class="arithmatex">\(\epsilon = 0.001\)</span>: <span class="arithmatex">\(N \geq 1,000,000\)</span> shots</p>
<p>Halving error requires <strong>4× shots</strong> (quadratic scaling).</p>
<p><strong>Multi-Observable Estimation:</strong></p>
<p>For Hamiltonian <span class="arithmatex">\(\mathbf{H} = \sum_{j=1}^T c_j \mathbf{P}_j\)</span> with Pauli terms:</p>
<p><strong>Naive Strategy:</strong><br />
Measure each term independently with <span class="arithmatex">\(N_j\)</span> shots:</p>
<div class="arithmatex">\[
\widehat{\langle\mathbf{H}\rangle} = \sum_{j=1}^T c_j \widehat{\langle\mathbf{P}_j\rangle}_{N_j}
\]</div>
<p>Variance:</p>
<div class="arithmatex">\[
\text{Var}[\widehat{\langle\mathbf{H}\rangle}] = \sum_{j=1}^T c_j^2 \cdot \frac{1 - \langle\mathbf{P}_j\rangle^2}{N_j}
\]</div>
<p>With uniform allocation <span class="arithmatex">\(N_j = N/T\)</span>:</p>
<div class="arithmatex">\[
\text{Var}[\widehat{\langle\mathbf{H}\rangle}] = \frac{T}{N}\sum_{j=1}^T c_j^2
\]</div>
<p>Total measurements: <span class="arithmatex">\(N_{\text{total}} = T \times (N/T) = N\)</span></p>
<p><strong>Commuting Group Optimization:</strong></p>
<p>Partition terms into <span class="arithmatex">\(M\)</span> commuting groups <span class="arithmatex">\(\{\mathcal{G}_m\}\)</span> where all <span class="arithmatex">\(\mathbf{P}_i, \mathbf{P}_j \in \mathcal{G}_m\)</span> satisfy <span class="arithmatex">\([\mathbf{P}_i, \mathbf{P}_j] = 0\)</span>.</p>
<p>Each group measured simultaneously in shared eigenbasis. Group variance:</p>
<div class="arithmatex">\[
\sigma_m^2 = \text{Var}\left[\sum_{\mathbf{P}_j \in \mathcal{G}_m} c_j \mathbf{P}_j\right] = \left\langle\left(\sum_j c_j\mathbf{P}_j\right)^2\right\rangle - \left(\sum_j c_j\langle\mathbf{P}_j\rangle\right)^2
\]</div>
<p>With <span class="arithmatex">\(N_m\)</span> shots per group:</p>
<div class="arithmatex">\[
\text{Var}[\widehat{\langle\mathbf{H}\rangle}] = \sum_{m=1}^M \frac{\sigma_m^2}{N_m}
\]</div>
<p><strong>Optimal Shot Allocation:</strong></p>
<p>Minimize variance subject to budget <span class="arithmatex">\(\sum_m N_m = N\)</span> using Lagrange multipliers:</p>
<div class="arithmatex">\[
\mathcal{L} = \sum_{m=1}^M \frac{\sigma_m^2}{N_m} + \lambda\left(\sum_{m=1}^M N_m - N\right)
\]</div>
<p>Setting <span class="arithmatex">\(\frac{\partial\mathcal{L}}{\partial N_m} = 0\)</span>:</p>
<div class="arithmatex">\[
-\frac{\sigma_m^2}{N_m^2} + \lambda = 0 \implies N_m \propto \sigma_m
\]</div>
<p>Normalizing:</p>
<div class="arithmatex">\[
N_m^* = N \cdot \frac{\sigma_m}{\sum_{k=1}^M \sigma_k}
\]</div>
<p>Minimum variance:</p>
<div class="arithmatex">\[
\text{Var}_{\min} = \frac{1}{N}\left(\sum_{m=1}^M \sigma_m\right)^2
\]</div>
<p><strong>Training Loop Shot Budget:</strong></p>
<p>For optimization with <span class="arithmatex">\(K\)</span> iterations, <span class="arithmatex">\(m\)</span> parameters:</p>
<p><strong>Using Parameter-Shift:</strong>
- Evaluations per gradient: <span class="arithmatex">\(2m\)</span><br />
- Shots per evaluation: <span class="arithmatex">\(N_{\text{shots}}\)</span><br />
- Total per iteration: <span class="arithmatex">\(2m \times N_{\text{shots}}\)</span><br />
- Total for training: <span class="arithmatex">\(K \times 2m \times N_{\text{shots}}\)</span></p>
<p><strong>Example:</strong><br />
<span class="arithmatex">\(K=500\)</span> iterations, <span class="arithmatex">\(m=100\)</span> parameters, <span class="arithmatex">\(N_{\text{shots}}=10^4\)</span>:</p>
<div class="arithmatex">\[
N_{\text{total}} = 500 \times 200 \times 10^4 = 10^9 \text{ measurements}
\]</div>
<p><strong>Adaptive Shot Strategies:</strong></p>
<ol>
<li><strong>Increasing schedule:</strong> <span class="arithmatex">\(N_k = N_0 \cdot (1 + k/K)^\alpha\)</span> with <span class="arithmatex">\(\alpha \sim 1-2\)</span>  </li>
<li><strong>Gradient-dependent:</strong> <span class="arithmatex">\(N_k \propto 1/\|\nabla\mathcal{L}_k\|\)</span> (more shots when gradients small)  </li>
<li><strong>Error-driven:</strong> Increase shots when <span class="arithmatex">\(|\mathcal{L}_k - \mathcal{L}_{k-1}| &lt; \delta\sigma_k\)</span></li>
</ol>
<p><strong>Variance Reduction Techniques:</strong></p>
<ol>
<li><strong>Observable grouping:</strong> Reduces bases from <span class="arithmatex">\(T\)</span> to <span class="arithmatex">\(M \ll T\)</span>  </li>
<li><strong>Control variates:</strong> Use known expectations as baselines  </li>
<li><strong>Importance sampling:</strong> Weight basis measurement frequencies  </li>
<li><strong>Classical shadows:</strong> Estimate many observables from single measurement data</li>
</ol>
<h3 id="comprehension-check_3"><strong>Comprehension Check</strong></h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. If you halve the standard error, how must shots change?</strong></p>
<ul>
<li>A. Halve shots  </li>
<li>B. Keep shots constant  </li>
<li>C. Double shots  </li>
<li>D. Quadruple shots  </li>
</ul>
<p><strong>2. Which tactic reduces measurement overhead?</strong></p>
<ul>
<li>A. Deeper circuits  </li>
<li>B. Grouping commuting terms  </li>
<li>C. Randomizing bases  </li>
<li>D. Fewer iterations regardless of loss  </li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>1: D</strong> — <span class="arithmatex">\(\epsilon\propto 1/\sqrt{N}\)</span> implies <span class="arithmatex">\(N\mapsto 4N\)</span>.<br />
<strong>2: B</strong> — Shared bases reduce distinct settings.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Why can measurement cost dominate end-to-end training time, and how would you budget shots across iterations?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>Measurement cost often dominates the total training time of a VQC for two primary reasons: the sheer volume of measurements required and the statistical nature of quantum mechanics.</p>
<p><strong>Why Measurement is Expensive:</strong></p>
<ol>
<li><strong>Shot Noise:</strong> To get a reliable estimate of an expectation value, you must repeat the circuit execution and measurement many times (thousands or millions of "shots"). The statistical error in your estimate decreases only as <span class="arithmatex">\(1/\sqrt{N}\)</span>, where <span class="arithmatex">\(N\)</span> is the number of shots. This means to halve your error, you must quadruple your shots.</li>
<li><strong>Iterative Optimization:</strong> Training a VQC involves many optimization steps (iterations).</li>
<li><strong>Gradient Calculation:</strong> At each step, calculating the gradient requires multiple circuit evaluations (e.g., <span class="arithmatex">\(2m\)</span> for the parameter-shift rule with <span class="arithmatex">\(m\)</span> parameters).</li>
</ol>
<p>The total number of shots is multiplicative: <code>(Number of Iterations) x (Circuits per Gradient) x (Shots per Circuit)</code>. This can quickly lead to billions or trillions of total shots, making measurement the main bottleneck.</p>
<p><strong>How to Budget Shots:</strong></p>
<p>A naive approach is to use a fixed, large number of shots for every step. A much more efficient strategy is to use an <strong>adaptive shot budget</strong>:</p>
<ol>
<li><strong>Start Low:</strong> In the early stages of training, when gradients are large and the optimizer is just exploring, precision is not critical. Use a low number of shots (e.g., 1,000) to get a rough estimate of the gradient direction quickly.</li>
<li><strong>Increase Gradually:</strong> As the optimization proceeds and the parameters get closer to a minimum, the gradients become smaller. To resolve these smaller gradients from the shot noise, you need more precision. Therefore, you should gradually increase the number of shots with each iteration.</li>
</ol>
<p>This adaptive approach concentrates the measurement budget on the later stages of training where it is most needed, leading to significant savings in both time and cost without sacrificing the quality of the final result.</p>
</details>
</div>
<h3 id="hands-on-projects_3"><strong><i class="fa-solid fa-flask"></i> Hands-On Projects</strong></h3>
<h4 id="project-blueprint_3"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Compute shot scaling to halve standard deviation and total shots for a run with many gradient calls.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td><span class="arithmatex">\(\epsilon\propto 1/\sqrt{N}\)</span>; linear accumulation of shot cost.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Given <span class="arithmatex">\(S=1000\)</span> shots baseline; 500 gradient evaluations; 8000 shots per evaluation.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>Find <span class="arithmatex">\(S'\)</span> with <span class="arithmatex">\(\epsilon'/\epsilon=1/2\)</span>; compute total shots <span class="arithmatex">\(=500\times 8000\)</span>.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td><span class="arithmatex">\(S'=4S\)</span>; total shots <span class="arithmatex">\(=4\times 10^6\)</span>.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td><span class="arithmatex">\(S\)</span>, <span class="arithmatex">\(S'\)</span>, evaluations, total shots.</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Arithmetic matches definitions.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Shot budget numbers and interpretation.</td>
</tr>
</tbody>
</table>
<h4 id="pseudocode-implementation_3"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>FUNCTION Analyze_Shot_Budget(baseline_shots_S, error_reduction_factor, num_gradient_evals):
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    # baseline_shots_S: The initial number of shots for a baseline error ε.
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    # error_reduction_factor: The factor by which to reduce the error (e.g., 2 for halving).
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    # num_gradient_evals: The total number of gradient evaluations in the run.
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    ASSERT baseline_shots_S &gt; 0 AND error_reduction_factor &gt; 0
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    # --- Shot Scaling for Precision ---
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    # Step 1: Calculate the new shot count S&#39; required for the desired error ε&#39;.
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    # Since error ε ~ 1/sqrt(S), to get ε&#39; = ε / factor, we need S&#39; = S * factor^2.
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    new_shots_per_eval = baseline_shots_S * (error_reduction_factor**2)
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    LOG &quot;To reduce error by a factor of &quot;, error_reduction_factor, &quot;, shots must increase from &quot;, baseline_shots_S, &quot; to &quot;, new_shots_per_eval, &quot;.&quot;
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    # Example from project: S=1000, factor=2 -&gt; S&#39; = 1000 * 4 = 4000.
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    # The project description uses a different baseline of 8000, let&#39;s use that.
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    shots_per_evaluation = 8000 # As per project description
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    LOG &quot;Using &quot;, shots_per_evaluation, &quot; shots per gradient evaluation.&quot;
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>    # --- Total Shot Budget Calculation ---
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    # Step 2: Calculate the total number of shots for the entire VQE run.
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>    # This is the number of gradient evaluations multiplied by the shots per evaluation.
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>    total_shots = num_gradient_evals * shots_per_evaluation
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>    LOG &quot;Total gradient evaluations: &quot;, num_gradient_evals
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>    LOG &quot;Total shot budget required for the run: &quot;, total_shots
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>    # --- Interpretation ---
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>    LOG &quot;This demonstrates the high measurement cost in VQAs.&quot;
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>    LOG &quot;A run with &quot;, num_gradient_evals, &quot; gradient steps, each requiring &quot;, shots_per_evaluation, &quot; shots,&quot;
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>    LOG &quot;consumes a total of &quot;, total_shots, &quot; circuit executions.&quot;
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>    RETURN new_shots_per_eval, total_shots
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>END FUNCTION
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>// Example usage based on project description:
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>// Analyze_Shot_Budget(baseline_shots_S=1000, error_reduction_factor=2, num_gradient_evals=500)
</span></code></pre></div>
<h4 id="outcome-and-interpretation_3"><strong>Outcome and Interpretation</strong></h4>
<p>You quantify how error bars trade against runtime and how training loops scale with measurement cost.</p>
<hr />
<h2 class="heading-with-pill" id="105-barren-plateaus-and-mitigation"><strong>10.5 Barren Plateaus and Mitigation</strong></h2>
<blockquote>
<p><strong>Difficulty:</strong> ★★★★☆</p>
<p><strong>Concept:</strong> Vanishing gradients in deep/random circuits and practical countermeasures</p>
<p><strong>Summary:</strong> Random deep ansätze drive gradients toward zero; mitigation uses shallow/structured layers, informed initialization, and locality to retain gradient signal.</p>
</blockquote>
<h3 id="theoretical-background_4"><strong>Theoretical Background</strong></h3>
<p>Barren plateaus are exponentially flat regions in the loss landscape of variational quantum circuits where gradients vanish, rendering gradient-based optimization infeasible.</p>
<p><strong>Formal Definition:</strong></p>
<p>For loss function <span class="arithmatex">\(\mathcal{L}(\vec{\theta})\)</span> with parameters initialized randomly, a barren plateau occurs when:</p>
<div class="arithmatex">\[
\text{Var}\left[\frac{\partial \mathcal{L}}{\partial \theta_j}\right] \in \mathcal{O}\left(\frac{1}{\text{poly}(2^n)}\right)
\]</div>
<p>The gradient variance vanishes exponentially with system size <span class="arithmatex">\(n\)</span>, making gradient signal indistinguishable from shot noise.</p>
<p><strong>McClean-Cerezo-Coles Theorem (2018):</strong></p>
<p>For random parameterized circuits forming approximate unitary 2-designs, measuring local observable <span class="arithmatex">\(\mathbf{O}\)</span> acting on <span class="arithmatex">\(k\)</span> qubits:</p>
<div class="arithmatex">\[
\mathbb{E}\left[\frac{\partial \langle\mathbf{O}\rangle}{\partial \theta_j}\right] = 0
\]</div>
<div class="arithmatex">\[
\text{Var}\left[\frac{\partial \langle\mathbf{O}\rangle}{\partial \theta_j}\right] \leq \frac{C}{2^n}
\]</div>
<p>where <span class="arithmatex">\(C\)</span> is constant independent of <span class="arithmatex">\(n\)</span>.</p>
<p><strong>Proof Sketch:</strong></p>
<p>Consider circuit <span class="arithmatex">\(\mathbf{U}(\vec{\theta}) = \mathbf{V} U_\ell(\theta_\ell) \mathbf{W}\)</span> where <span class="arithmatex">\(\mathbf{V}, \mathbf{W}\)</span> are random unitaries forming 2-design.</p>
<p>Expectation over Haar measure:</p>
<div class="arithmatex">\[
\mathbb{E}_{\mathbf{V},\mathbf{W}}\left[|\langle\psi|\mathbf{V}^\dagger \mathbf{O} \mathbf{V}|\psi\rangle|^2\right] = \frac{\text{Tr}(\mathbf{O})^2 + \text{Tr}(\mathbf{O}^2)}{2^n(2^n+1)}
\]</div>
<p>For local <span class="arithmatex">\(\mathbf{O}\)</span> with <span class="arithmatex">\(\text{Tr}(\mathbf{O}) = 0\)</span> and <span class="arithmatex">\(\text{Tr}(\mathbf{O}^2) = \mathcal{O}(1)\)</span>:</p>
<div class="arithmatex">\[
\text{Var}[\langle\mathbf{O}\rangle] \sim \mathcal{O}(1/2^n)
\]</div>
<p>Differentiating with respect to parameter preserves this scaling.</p>
<p><strong>Conditions for Barren Plateaus:</strong></p>
<ol>
<li>
<p><strong>Deep Random Circuits:</strong><br />
   Depth <span class="arithmatex">\(L \geq \mathcal{O}(n)\)</span> with random gates approaches Haar distribution. Circuits with <span class="arithmatex">\(L \gtrsim n \log n\)</span> gates form approximate 2-designs.</p>
</li>
<li>
<p><strong>Global Entanglement:</strong><br />
   All-to-all connectivity or long-range gates create volume-law entanglement entropy:</p>
</li>
</ol>
<p>$$
   S(\rho_A) \sim |A| \log 2
   $$</p>
<p>for bipartition <span class="arithmatex">\(A\)</span>. Maximal entanglement correlates with gradient vanishing.</p>
<ol>
<li><strong>Hardware-Efficient Ansätze at Depth:</strong><br />
   Even structured circuits exhibit barren plateaus beyond critical depth <span class="arithmatex">\(L_c \sim \mathcal{O}(n)\)</span>.</li>
</ol>
<p><strong>Gradient Scaling Laws:</strong></p>
<p><strong>Local Observable (<span class="arithmatex">\(k\)</span>-local):</strong>
$$
\text{Var}\left[\frac{\partial\langle\mathbf{O}_k\rangle}{\partial\theta}\right] \sim \mathcal{O}(&frac12;^n)
$$</p>
<p><strong>Global Observable (all <span class="arithmatex">\(n\)</span> qubits):</strong>
$$
\text{Var}\left[\frac{\partial\langle\mathbf{O}_n\rangle}{\partial\theta}\right] \sim \mathcal{O}(1)
$$</p>
<p>Global observables preserve gradients but may not reflect problem structure.</p>
<p><strong>Practical Implications:</strong></p>
<p>For <span class="arithmatex">\(n=50\)</span> qubits with local observable:</p>
<div class="arithmatex">\[
\text{Var}[\partial\mathcal{L}/\partial\theta] \sim 2^{-50} \approx 10^{-15}
\]</div>
<p>Standard error from <span class="arithmatex">\(N\)</span> shots: <span class="arithmatex">\(\sigma \sim 1/\sqrt{N}\)</span>. To resolve gradient:</p>
<div class="arithmatex">\[
|\partial\mathcal{L}/\partial\theta| &gt; 2\sigma \implies \sqrt{2^{-50}} &gt; 2/\sqrt{N} \implies N &gt; 2^{52} \approx 4.5 \times 10^{15}
\]</div>
<p>Completely infeasible.</p>
<p><strong>Mitigation Strategies:</strong></p>
<p><strong>1. Shallow Circuits:</strong><br />
Restrict depth to <span class="arithmatex">\(L \ll n\)</span>. For many tasks, <span class="arithmatex">\(L = \mathcal{O}(\log n)\)</span> sufficient:</p>
<div class="arithmatex">\[
L \leq c \log n, \quad c \sim 2-5
\]</div>
<p>Prevents 2-design formation while maintaining polynomial expressibility.</p>
<p><strong>2. Local Cost Functions:</strong><br />
Decompose global loss into sum of local terms:</p>
<div class="arithmatex">\[
\mathcal{L}(\vec{\theta}) = \sum_{i} w_i \langle\mathbf{O}_i\rangle, \quad \text{supp}(\mathbf{O}_i) = \mathcal{O}(1)
\]</div>
<p>Each term's gradient scales as <span class="arithmatex">\(\mathcal{O}(1/2^k)\)</span> where <span class="arithmatex">\(k\)</span> is support size, avoiding full <span class="arithmatex">\(2^n\)</span> suppression.</p>
<p><strong>3. Parameter Initialization:</strong>  </p>
<p><strong>Identity-near initialization:</strong>
$$
\theta_j \sim \mathcal{N}(0, \sigma^2), \quad \sigma \ll 1
$$</p>
<p>Keeps circuit close to identity initially, avoiding random regime.</p>
<p><strong>Problem-informed initialization:</strong><br />
For chemistry VQE, initialize at Hartree-Fock solution or UCC with small excitations.</p>
<p><strong>4. Layer-wise Training:</strong><br />
Train one layer at a time:</p>
<ol>
<li>Optimize <span class="arithmatex">\(\vec{\theta}_1\)</span> with single layer <span class="arithmatex">\(\mathbf{U}(\vec{\theta}_1)\)</span>  </li>
<li>Freeze <span class="arithmatex">\(\vec{\theta}_1^*\)</span>, add second layer, optimize <span class="arithmatex">\(\vec{\theta}_2\)</span>  </li>
<li>Repeat for <span class="arithmatex">\(L\)</span> layers</li>
</ol>
<p>Never optimizes deep circuit simultaneously.</p>
<p><strong>5. Structured Ansätze:</strong></p>
<p><strong>Equivariant circuits:</strong><br />
Respect problem symmetries, restricting to smaller effective Hilbert space:</p>
<div class="arithmatex">\[
\dim(\mathcal{H}_{\text{eff}}) \ll 2^n
\]</div>
<p>Gradient variance scales with effective dimension.</p>
<p><strong>Problem-specific templates:</strong><br />
UCC for chemistry, QAOA for optimization preserve structure preventing random exploration.</p>
<p><strong>6. Gradient-Free Optimizers:</strong><br />
When gradients unavoidable small, use:</p>
<ul>
<li><strong>SPSA:</strong> 2 evaluations regardless of dimension  </li>
<li><strong>CMA-ES:</strong> Covariance matrix adaptation  </li>
<li><strong>Genetic algorithms:</strong> Population-based search</li>
</ul>
<p>These don't rely on gradient magnitude but converge slower.</p>
<p><strong>Alternative Formulations:</strong></p>
<p><strong>Tensor network initialization:</strong><br />
Prepare initial state via classical tensor network (e.g., MPS) matching problem structure, use VQC for refinement.</p>
<p><strong>Overlap-based losses:</strong><br />
Replace <span class="arithmatex">\(\langle\mathbf{H}\rangle\)</span> with overlap fidelity:</p>
<div class="arithmatex">\[
\mathcal{L}(\vec{\theta}) = 1 - |\langle\psi_{\text{target}}|\psi(\vec{\theta})\rangle|^2
\]</div>
<p>Gradient properties differ, may avoid plateaus for certain targets.</p>
<p><strong>Theoretical Landscape:</strong></p>
<p>Barren plateaus fundamental to random quantum circuits but <strong>not universal curse</strong>. Many real-world problems have structure allowing polynomial trainability. Key: match ansatz architecture to problem symmetry and locality.</p>
<h3 id="comprehension-check_4"><strong>Comprehension Check</strong></h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What symptom characterizes a barren plateau?</strong></p>
<ul>
<li>A. Exploding gradients  </li>
<li>B. Vanishing gradients  </li>
<li>C. Oscillating loss  </li>
<li>D. Deterministic measurements  </li>
</ul>
<p><strong>2. Which approach mitigates plateaus?</strong></p>
<ul>
<li>A. Increase random depth  </li>
<li>B. Local cost functions and shallow blocks  </li>
<li>C. Remove encoders  </li>
<li>D. Ignore noise  </li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>1: B</strong> — Gradients concentrate near zero.<br />
<strong>2: B</strong> — Local objectives and structure maintain gradient magnitude.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Outline a mitigation plan when training stalls due to vanishing gradients.</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>When a VQC training process stalls and the gradients vanish (a "barren plateau"), it means the optimization landscape is too flat to navigate. Here is a step-by-step mitigation plan:</p>
<ol>
<li>
<p><strong>Diagnose the Issue:</strong></p>
<ul>
<li>First, confirm that you are in a barren plateau by monitoring the norm of the gradient vector. If it's consistently close to zero (e.g., <span class="arithmatex">\(&lt; 10^{-4}\)</span>), a barren plateau is likely the cause.</li>
</ul>
</li>
<li>
<p><strong>Reduce Circuit Complexity:</strong></p>
<ul>
<li><strong>Reduce Depth:</strong> The most direct solution. Systematically reduce the number of layers in your ansatz. Deeper circuits are more prone to barren plateaus. Find the minimum depth that is still expressive enough for your problem.</li>
<li><strong>Use Local Entanglement:</strong> Replace global or random entanglement patterns with local ones (e.g., nearest-neighbor CNOTs). This restricts the flow of information and helps preserve the gradient signal.</li>
</ul>
</li>
<li>
<p><strong>Adjust Initialization:</strong></p>
<ul>
<li><strong>Initialize Near Identity:</strong> Instead of initializing parameters randomly across a large range (like <span class="arithmatex">\([-\pi, \pi]\)</span>), initialize them with small values close to zero (e.g., from a normal distribution <span class="arithmatex">\(\mathcal{N}(0, 0.01)\)</span>). This ensures the initial circuit is not in a flat region of the landscape.</li>
</ul>
</li>
<li>
<p><strong>Employ Advanced Techniques:</strong></p>
<ul>
<li><strong>Layer-wise Training:</strong> Train one layer of the ansatz at a time. Once the first layer is converged, freeze its parameters and add a new layer to train. This builds a deep circuit without ever having to optimize all the parameters of a deep circuit at once.</li>
<li><strong>Use a different Optimizer:</strong> Sometimes, a different classical optimizer can help escape a barren plateau.</li>
</ul>
</li>
</ol>
<p>By systematically applying these strategies, you can often restore the trainability of your model and escape the barren plateau.</p>
</details>
</div>
<h3 id="hands-on-projects_4"><strong><i class="fa-solid fa-flask"></i> Hands-On Projects</strong></h3>
<h4 id="project-blueprint_4"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Diagnose gradient norms across depths <span class="arithmatex">\(L\in\{1,2,3\}\)</span> for a fixed ansatz and encoder.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>Gradient norm <span class="arithmatex">\(\lVert\nabla C\rVert\)</span> vs. depth as a proxy for trainability.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Same dataset/encoder; increase layers; estimate gradient norms at random inits.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>Initialize small angles; measure <span class="arithmatex">\(\lVert\nabla C\rVert\)</span>; compare across <span class="arithmatex">\(L\)</span>.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>Norms shrink with depth for random inits; structure lessens decay.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td><span class="arithmatex">\(L\)</span>, <span class="arithmatex">\(\lVert\nabla C\rVert\)</span>, shots per estimate.</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Monotone decrease in random-deep case; mitigated with structure.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Table of gradient norms vs. depth with narrative.</td>
</tr>
</tbody>
</table>
<h4 id="pseudocode-implementation_4"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>FUNCTION Diagnose_Barren_Plateaus(depth_list, num_qubits, num_samples):
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    # depth_list: A list of circuit depths to test, e.g., [1, 5, 10].
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    # num_qubits: The number of qubits in the circuit.
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    # num_samples: The number of random initializations to average over.
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    gradient_variances = {}
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    FOR L IN depth_list:
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        LOG &quot;Analyzing depth L = &quot;, L
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        gradients_for_this_depth = []
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        FOR i IN 1..num_samples:
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>            # Step 1: Define a random, deep ansatz for the given depth.
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>            Ansatz = Build_Random_Hardware_Efficient_Ansatz(num_qubits, depth=L)
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>            # Step 2: Initialize with random parameters.
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>            random_params = Random_Initialize_Params(Ansatz.num_params)
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>            # Step 3: Compute the gradient of a single parameter.
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>            # The cost function is typically the expectation of a local observable (e.g., Z on one qubit).
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>            CostFunction = Expectation_Value(Pauli_Z(qubit_index=0))
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>            # We compute the gradient with respect to the first parameter, for instance.
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>            gradient_component = Compute_Gradient_Component(
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>                CostFunction, Ansatz, random_params, param_index=0
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>            )
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>            gradients_for_this_depth.append(gradient_component)
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>        END FOR
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>        # Step 4: Calculate the variance of the collected gradient components.
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>        variance = Variance(gradients_for_this_depth)
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>        gradient_variances[L] = variance
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>        LOG &quot;Variance of gradient for L=&quot;, L, &quot; is &quot;, variance
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>    END FOR
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a>    # Step 5: Analyze the results.
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>    # We expect the variance to decrease as the depth L increases,
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>    # which is the signature of a barren plateau.
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>    LOG &quot;Gradient variance vs. depth: &quot;, gradient_variances
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a>    LOG &quot;If variance decreases exponentially with depth, a barren plateau is present.&quot;
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>    RETURN gradient_variances
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a>END FUNCTION
</span></code></pre></div>
<h4 id="outcome-and-interpretation_4"><strong>Outcome and Interpretation</strong></h4>
<p>You connect architectural choices to trainability via measurable gradient statistics.</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../chapter-9/Chapter-9-Workbook/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter-9 Encoding Classical Data into Quantum States">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Chapter-9 Encoding Classical Data into Quantum States
              </div>
            </div>
          </a>
        
        
          
          <a href="../../chapter-11/Chapter-11-Workbook/" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter-11 Supervised Quantum Machine Learning">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Chapter-11 Supervised Quantum Machine Learning
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://bigbookofcomputing.github.io" target="_blank" rel="noopener" title="bigbookofcomputing.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bigbookofcomputing" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@big-book-of-computing" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../static/mathjax-config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>